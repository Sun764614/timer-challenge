<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>과녁 맞추기 게임</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background: #f0f4f8; /* 연한 회색 배경 */
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            justify-content: center;
            align-items: center;
            color: #333;
            overflow: hidden; /* 스크롤 방지 */
        }
        h1 {
            color: #1a4d2e; /* 진한 녹색 */
            font-size: 2.8em;
            margin-bottom: 10px; /* 간격 조정 */
        }
        #instruction {
            font-size: 1.2em;
            color: #555;
            margin-bottom: 10px;
        }
        #gameInfo {
            font-size: 1.8em;
            font-weight: bold;
            color: #2e8b57; /* 중간 녹색 */
            margin-bottom: 20px;
        }
        #scoreDisplay, #timerDisplay {
            margin: 0 10px;
        }

        #targetContainer {
            width: 400px; /* 과녁판 전체 크기 */
            height: 400px;
            position: relative; /* 자식 요소의 위치 지정을 위해 */
            margin: 20px auto;
            border-radius: 50%; /* 전체를 원형으로 */
            overflow: hidden; /* 원형 밖으로 나가는 부분 숨김 */
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            cursor: crosshair; /* 십자 모양 커서 */
            background-color: #fff; /* 기본 배경색 */
        }

        .target-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            /* display: flex; 이 속성은 제거하여 중앙 정렬 방지 */
            /* justify-content: center; */
            /* align-items: center; */
            font-weight: bold;
            color: white; /* 텍스트 색상 */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3); /* 안쪽 그림자 */
            /* font-size: 1.8em; 이 속성은 .ring-score가 덮어씁니다 */
            /* text-shadow: 1px 1px 2px rgba(0,0,0,0.5); */
        }
        
        /* 10점 링의 점수만 특별히 중앙에 표시 */
        .ring-10 {
            display: flex; /* 10점 링만 다시 flexbox 사용하여 중앙 정렬 */
            justify-content: center;
            align-items: center;
            font-size: 1.8em; /* 10점 폰트 크기 */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* 그림자 */
        }

        /* .ring-score는 이제 10점 링 내부에서만 사용됩니다. */
        .ring-score {
            pointer-events: none; /* 클릭 이벤트 방해하지 않음 */
            /* 나머지 점수 텍스트는 JS에서 추가하지 않으므로, 이 스타일은 10점 링에만 적용됩니다. */
        }


        /* 과녁 링 스타일 (점수별로 크기와 색상 정의) */
        .ring-5 { width: 400px; height: 400px; background-color: #4682b4; } /* 파랑 */
        .ring-6 { width: 320px; height: 320px; background-color: #1e90ff; } /* 하늘색 */
        .ring-7 { width: 240px; height: 240px; background-color: #3cb371; } /* 초록 */
        .ring-8 { width: 160px; height: 160px; background-color: #ffd700; } /* 노랑 */
        .ring-9 { width: 80px; height: 80px; background-color: #dc143c; } /* 빨강 */
        .ring-10 { width: 40px; height: 40px; background-color: #000; } /* 검정 중앙 (황소 눈) */


        #hitMarker {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: rgb(255, 0, 0); /* 빨간색 점 */
            border-radius: 50%;
            transform: translate(-50%, -50%); /* 중앙 정렬 */
            pointer-events: none; /* 클릭 이벤트 방해하지 않음 */
            opacity: 0; /* 초기에는 숨김 */
            transition: opacity 0.1s ease-out;
            z-index: 100; /* 과녁 위에 표시 */
        }

        #message {
            font-size: 1.5em;
            font-weight: bold;
            color: #c2185b;
            min-height: 1.5em;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .start-buttons button {
            padding: 15px 30px;
            font-size: 1.8em;
            font-weight: bold;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            margin: 10px 5px; /* 버튼 사이 간격 */
        }
        .start-buttons button:hover {
            background-color: #0056b3;
        }
        .start-buttons button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        #resetButton {
            background-color: #6c757d; /* 회색 */
        }
        #resetButton:hover {
            background-color: #5a6268;
        }

        /* 모바일 반응형 */
        @media (max-width: 600px) {
            h1 {
                font-size: 2.2em;
            }
            #instruction {
                font-size: 1em;
            }
            #gameInfo {
                font-size: 1.5em;
            }
            #targetContainer {
                width: 300px;
                height: 300px;
            }
            .target-ring.ring-5 { width: 300px; height: 300px; }
            .target-ring.ring-6 { width: 240px; height: 240px; }
            .target-ring.ring-7 { width: 180px; height: 180px; }
            .target-ring.ring-8 { width: 120px; height: 120px; }
            .target-ring.ring-9 { width: 60px; height: 60px; }
            .target-ring.ring-10 { width: 30px; height: 30px; }
            
            /* 모바일에서 10점 링 폰트 크기 조정 */
            .ring-10 {
                font-size: 1.5em; /* 모바일에서 10점 폰트 크기 */
            }

            .start-buttons button {
                padding: 12px 25px;
                font-size: 1.5em;
            }
            #message {
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <h1>🎯 과녁 맞추기 게임! 🏹</h1>
    <div id="instruction">화면을 터치하거나 클릭하여 점수를 획득하세요!</div>
    <div id="gameInfo">
        <span id="scoreDisplay">점수: 0</span> | <span id="timerDisplay">남은 시간: 30초</span>
    </div>

    <div id="targetContainer">
        <div id="hitMarker"></div> </div>
    
    <div id="message">시작 버튼을 눌러 게임을 시작하세요!</div>

    <div class="start-buttons">
        <button id="startButton30">30초 시작</button>
        <button id="startButton60">1분 시작</button>
        <button id="resetButton" style="display: none;">다시 시작</button>
    </div>

    <script>
        const targetContainer = document.getElementById('targetContainer');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const timerDisplay = document.getElementById('timerDisplay');
        const messageDisplay = document.getElementById('message');
        const startButton30 = document.getElementById('startButton30');
        const startButton60 = document.getElementById('startButton60');
        const resetButton = document.getElementById('resetButton');
        const hitMarker = document.getElementById('hitMarker');

        let score = 0;
        let timeLeft = 30; // 기본 시간 30초
        let gameInterval;
        let gameActive = false;
        let selectedDuration = 30; // 현재 선택된 게임 시간 (초)

        const targetRingsConfig = [
            { score: 10, class: 'ring-10', sizeRatio: 0.1 }, // 가장 안쪽 검정
            { score: 9, class: 'ring-9', sizeRatio: 0.2 },   // 빨강
            { score: 8, class: 'ring-8', sizeRatio: 0.4 },   // 노랑
            { score: 7, class: 'ring-7', sizeRatio: 0.6 },   // 초록
            { score: 6, class: 'ring-6', sizeRatio: 0.8 },   // 하늘색
            { score: 5, class: 'ring-5', sizeRatio: 1.0 }    // 가장 바깥쪽 파랑
        ];

        // 과녁 링 생성 함수
        function createTargetRings() {
            targetContainer.innerHTML = ''; // 기존 링 제거
            // 가장 바깥 링부터 안쪽으로 그려야 겹쳐서 보임
            for (let i = targetRingsConfig.length - 1; i >= 0; i--) {
                const ring = targetRingsConfig[i];
                const ringDiv = document.createElement('div');
                ringDiv.classList.add('target-ring', ring.class);
                ringDiv.style.width = `${targetContainer.offsetWidth * ring.sizeRatio}px`;
                ringDiv.style.height = `${targetContainer.offsetHeight * ring.sizeRatio}px`;
                
                // ✨ 10점 링에만 점수 텍스트를 추가합니다.
                if (ring.score === 10) {
                    ringDiv.textContent = ring.score; // 10점 텍스트 추가
                }
                
                targetContainer.appendChild(ringDiv);
            }
            targetContainer.appendChild(hitMarker); // 마커가 항상 가장 위에 있도록 다시 추가
        }

        function calculateScore(clickX, clickY) {
            const containerRect = targetContainer.getBoundingClientRect();
            const centerX = containerRect.width / 2;
            const centerY = containerRect.height / 2;

            // 클릭된 좌표를 컨테이너 내에서의 상대 좌표로 변환 (중심이 (0,0)이 되도록)
            const relativeX = clickX - containerRect.left - centerX;
            const relativeY = clickY - containerRect.top - centerY;

            // 중심으로부터의 거리 계산
            const distance = Math.sqrt(relativeX * relativeX + relativeY * relativeY);

            const maxRadius = containerRect.width / 2; // 가장 바깥쪽 링의 반지름

            let points = 0;
            // 가장 안쪽 링부터 바깥쪽으로 검사 (거리가 작을수록 높은 점수)
            for (let i = 0; i < targetRingsConfig.length; i++) {
                const ring = targetRingsConfig[i];
                const ringRadius = maxRadius * ring.sizeRatio;
                if (distance <= ringRadius) {
                    points = ring.score;
                    break;
                }
            }
            return points;
        }

        function handleShot(event) {
            if (!gameActive) return;

            // 클릭된 정확한 좌표 가져오기
            const clickX = event.clientX;
            const clickY = event.clientY;

            // hitMarker 표시
            hitMarker.style.left = `${clickX}px`;
            hitMarker.style.top = `${clickY}px`;
            hitMarker.style.opacity = '1';
            setTimeout(() => {
                hitMarker.style.opacity = '0'; // 잠시 후 사라지게
            }, 300); // 0.3초 후 사라짐

            const points = calculateScore(clickX, clickY);
            score += points;
            scoreDisplay.textContent = `점수: ${score}`;
            messageDisplay.textContent = `${points}점 획득!`;
            messageDisplay.style.color = points > 0 ? '#28a745' : '#dc3545'; // 점수에 따라 색상 변경
            setTimeout(() => messageDisplay.textContent = '', 500); // 메시지 0.5초 후 제거
        }

        function startGame(duration) {
            if (gameActive) return; // 이미 게임 중이면 시작 안함

            selectedDuration = duration;
            score = 0;
            timeLeft = duration;
            gameActive = true;

            startButton30.disabled = true;
            startButton60.disabled = true;
            resetButton.style.display = 'none'; // 게임 시작 시 리셋 버튼 숨김

            scoreDisplay.textContent = `점수: ${score}`;
            timerDisplay.textContent = `남은 시간: ${timeLeft}초`;
            messageDisplay.textContent = '게임을 시작합니다! 과녁을 클릭하세요!';
            messageDisplay.style.color = '#2e8b57';

            gameInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `남은 시간: ${timeLeft}초`;

                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000); // 1초마다 타이머 감소
        }

        function endGame() {
            clearInterval(gameInterval);
            gameActive = false;
            messageDisplay.textContent = `게임 종료! 최종 점수: ${score}점`;
            messageDisplay.style.color = '#c2185b';

            startButton30.disabled = false;
            startButton60.disabled = false;
            resetButton.style.display = 'inline-block'; // 게임 종료 시 리셋 버튼 표시
        }

        function resetGame() {
            endGame(); // 혹시 모를 타이머 중지
            score = 0;
            timeLeft = selectedDuration; // 선택했던 시간으로 다시 초기화
            scoreDisplay.textContent = `점수: ${score}`;
            timerDisplay.textContent = `남은 시간: ${timeLeft}초`;
            messageDisplay.textContent = '시작 버튼을 눌러 게임을 시작하세요!';
            messageDisplay.style.color = '#c2185b';

            startButton30.disabled = false;
            startButton60.disabled = false;
            resetButton.style.display = 'none';
        }

        // 이벤트 리스너
        targetContainer.addEventListener('click', handleShot);
        startButton30.addEventListener('click', () => startGame(30)); // 30초 시작
        startButton60.addEventListener('click', () => startGame(60)); // 1분 시작
        resetButton.addEventListener('click', resetGame);

        // 초기 과녁 링 생성
        createTargetRings();

        // 윈도우 크기 변경 시 과녁판 크기 및 링 재생성 (반응형)
        window.addEventListener('resize', createTargetRings);

        // 터치 이벤트도 처리 (모바일)
        targetContainer.addEventListener('touchstart', (event) => {
            event.preventDefault(); // 기본 터치 동작 (스크롤 등) 방지
            handleShot(event.touches[0]); // 첫 번째 터치 지점 사용
        });

        // 초기 타이머 표시 (기본 30초)
        timerDisplay.textContent = `남은 시간: ${timeLeft}초`;
    </script>
</body>
</html>