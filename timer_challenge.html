<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Timer Challenge for KY YH</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background: #f0f8ff;
      margin: 0;
      padding: 20px;
      display: flex; /* Flexbox ì‚¬ìš© */
      flex-direction: column; /* ì„¸ë¡œ ë°©í–¥ ì •ë ¬ */
      min-height: 100vh; /* ë·°í¬íŠ¸ ì „ì²´ ë†’ì´ ì‚¬ìš© */
      justify-content: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
      align-items: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
    }
    h1 {
      color: #2c3e50;
      margin-bottom: 10px;
    }
    #header {
      font-size: 22px;
      margin-bottom: 20px;
      color: #4a90e2;
      font-weight: bold;
    }
    #timerCircle {
      width: 300px;
      height: 300px;
      border: 6px solid #333;
      border-radius: 50%;
      margin: 20px auto;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
      background: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: background-color 0.3s ease; /* ë°°ê²½ìƒ‰ ë³€í™” ì• ë‹ˆë©”ì´ì…˜ */
    }
    .button-group {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap; /* ì‘ì€ í™”ë©´ì—ì„œ ë²„íŠ¼ ì¤„ë°”ê¿ˆ */
      justify-content: center;
      gap: 8px; /* ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
    }
    .button-group button {
      font-size: 18px; /* ë²„íŠ¼ í°íŠ¸ í¬ê¸° ì¡°ì • */
      padding: 10px 20px;
      border-radius: 8px;
      border: 2px solid #666;
      background-color: #e0e0e0;
      cursor: pointer;
      transition: background-color 0.2s, border-color 0.2s;
    }
    .button-group button:hover {
      background-color: #d0d0d0;
    }
    .button-group button.active { /* í™œì„± ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
      background-color: #4CAF50;
      color: white;
      border-color: #4CAF50;
    }
    .input-row { /* ì…ë ¥ í•„ë“œì™€ ì„¤ì • ë²„íŠ¼ì„ í•œ ì¤„ì— ë°°ì¹˜í•˜ê¸° ìœ„í•œ ìŠ¤íƒ€ì¼ */
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 10px; /* ìƒë‹¨ ì—¬ë°± */
    }
    input[type="number"] {
      font-size: 18px;
      padding: 8px 12px;
      border-radius: 8px;
      border: 2px solid #ccc;
      width: 100px;
      text-align: center;
      margin-right: 5px; /* ë²„íŠ¼ê³¼ì˜ ê°„ê²© */
    }
    .highlight {
      font-size: 20px; /* í°íŠ¸ í¬ê¸° ì¡°ì • */
      margin-top: 25px;
      color: #2c3e50;
      font-weight: bold;
    }
    #result {
      font-size: 28px;
      font-weight: bold;
      margin-top: 30px;
      min-height: 40px; /* ê²°ê³¼ í‘œì‹œ ì˜ì—­ ìµœì†Œ ë†’ì´ */
    }
    .success {
      color: #28a745; /* ë” ì§„í•œ ì´ˆë¡ìƒ‰ */
    }
    .fail {
      color: #dc3545; /* ë” ì§„í•œ ë¹¨ê°„ìƒ‰ */
    }
    #controlButtons {
      margin-top: 20px;
    }
    #controlButtons button {
      font-size: 22px;
      padding: 12px 28px;
      margin: 0 10px;
      border-radius: 10px;
      border: 2px solid #333;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      transition: background-color 0.2s;
    }
    #controlButtons button:hover {
      background-color: #0056b3;
    }
    #currentSettings { /* í˜„ì¬ ì„¤ì • ê°’ í‘œì‹œ ìŠ¤íƒ€ì¼ */
      margin-top: 20px;
      font-size: 20px;
      color: #555;
      font-weight: bold;
    }

    /* -------------------- ëª¨ë°”ì¼ ë°˜ì‘í˜• ìµœì í™” -------------------- */
    @media (max-width: 600px) { /* í™”ë©´ ë„ˆë¹„ 600px ì´í•˜ì¼ ë•Œ ì ìš© */
      body {
        padding: 10px; /* íŒ¨ë”© ì¤„ì„ */
      }
      #header {
        font-size: 18px; /* í—¤ë” í°íŠ¸ í¬ê¸° ì¤„ì„ */
        margin-bottom: 15px;
      }
      #timerCircle {
        width: 250px; /* ì› í¬ê¸° ì¤„ì„ */
        height: 250px;
        font-size: 50px; /* ì› ë‚´ë¶€ ìˆ«ì í°íŠ¸ í¬ê¸° ì¤„ì„ */
        margin: 15px auto;
      }
      .button-group {
        gap: 6px; /* ë²„íŠ¼ ê°„ê²© ì¤„ì„ */
      }
      .button-group button {
        font-size: 16px; /* ë²„íŠ¼ í°íŠ¸ í¬ê¸° ì¤„ì„ */
        padding: 8px 15px; /* ë²„íŠ¼ íŒ¨ë”© ì¤„ì„ */
      }
      .input-row button, .input-row input { /* ì§ì ‘ ì…ë ¥ ì„¤ì • ë²„íŠ¼ê³¼ ì…ë ¥ì°½ */
        font-size: 16px;
        padding: 6px 10px;
        width: 80px; /* ì…ë ¥ì°½ ë„ˆë¹„ ì¤„ì„ */
      }
      .highlight {
        font-size: 18px; /* ê°•ì¡° í…ìŠ¤íŠ¸ í°íŠ¸ í¬ê¸° ì¤„ì„ */
        margin-top: 20px;
      }
      #result {
        font-size: 24px; /* ê²°ê³¼ í°íŠ¸ í¬ê¸° ì¤„ì„ */
        margin-top: 25px;
      }
      #controlButtons button {
        font-size: 18px; /* ì œì–´ ë²„íŠ¼ í°íŠ¸ í¬ê¸° ì¤„ì„ */
        padding: 10px 20px;
        margin: 0 5px; /* ì œì–´ ë²„íŠ¼ ê°„ê²© ì¤„ì„ */
      }
      #currentSettings {
        font-size: 16px; /* í˜„ì¬ ì„¤ì • í°íŠ¸ í¬ê¸° ì¤„ì„ */
        margin-top: 15px;
      }
    }
  </style>
</head>
<body>
  
  <div id="timerCircle">0.00</div>

  <div id="currentSettings">í˜„ì¬ ì„¤ì •: ëª©í‘œ 10.0ì´ˆ, í—ˆìš© ì˜¤ì°¨ Â±0.1ì´ˆ</div>

  <div class="highlight">ğŸ¯ ëª©í‘œ ì‹œê°„ ì„¤ì •:</div>
  <div class="button-group" id="targetButtons"></div>
  <div class="input-row"> <input type="number" step="0.1" id="customTarget" placeholder="ì§ì ‘ ì…ë ¥">
    <button onclick="setCustomTarget()">ì„¤ì •</button>
  </div>

  <div class="highlight">â± í—ˆìš© ì˜¤ì°¨ ì„¤ì •:</div>
  <div class="button-group" id="toleranceButtons"></div>
  <div class="input-row"> <input type="number" step="0.1" id="customTolerance" placeholder="ì§ì ‘ ì…ë ¥">
    <button onclick="setCustomTolerance()">ì„¤ì •</button>
  </div>

  <div id="controlButtons">
    <button id="startButton" onclick="startTimer()">ì‹œì‘</button>
    <button id="stopButton" onclick="stopTimer()" disabled>ì •ì§€</button>
    <button id="resetButton" onclick="resetTimer()">ì´ˆê¸°í™”</button>
  </div>

  <div id="result">ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‹œì‘</div>

  <script>
    let targetTime = 10.0;
    let tolerance = 0.1;
    let startTime = null;
    let timerRunning = false;
    let animationFrameId = null; // requestAnimationFrame ID ì €ì¥
    const timerEl = document.getElementById("timerCircle");
    const resultEl = document.getElementById("result");
    const currentSettingsEl = document.getElementById("currentSettings"); // í˜„ì¬ ì„¤ì • ì—˜ë¦¬ë¨¼íŠ¸
    const startButton = document.getElementById("startButton");
    const stopButton = document.getElementById("stopButton");
    const resetButton = document.getElementById("resetButton");

    const targetButtonsValues = [5, 10, 15, 20];
    const toleranceButtonsValues = [0.1, 0.2, 0.3, 0.4, 0.5];

    // UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (í˜„ì¬ ì„¤ì • ê°’ í‘œì‹œ ë° ë²„íŠ¼ í™œì„±/ë¹„í™œì„±, active í´ë˜ìŠ¤ ê´€ë¦¬)
    function updateUI() {
      // í˜„ì¬ ì„¤ì • í‘œì‹œ
      currentSettingsEl.textContent = `í˜„ì¬ ì„¤ì •: ëª©í‘œ ${targetTime.toFixed(1)}ì´ˆ, í—ˆìš© ì˜¤ì°¨ Â±${tolerance.toFixed(1)}ì´ˆ`;

      // ëª©í‘œ ì‹œê°„ ë²„íŠ¼ í™œì„± ìƒíƒœ ì—…ë°ì´íŠ¸
      document.querySelectorAll('#targetButtons button').forEach(btn => {
        if (parseFloat(btn.textContent) === targetTime) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
      // í—ˆìš© ì˜¤ì°¨ ë²„íŠ¼ í™œì„± ìƒíƒœ ì—…ë°ì´íŠ¸
      document.querySelectorAll('#toleranceButtons button').forEach(btn => {
        if (parseFloat(btn.textContent) === tolerance) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });

      // ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” ìƒíƒœ
      startButton.disabled = timerRunning;
      stopButton.disabled = !timerRunning;
      resetButton.disabled = timerRunning; // íƒ€ì´ë¨¸ ì‹¤í–‰ ì¤‘ì—ëŠ” ì´ˆê¸°í™” ë¶ˆê°€
    }

    // ë²„íŠ¼ ìƒì„± í•¨ìˆ˜
    function createButtons() {
      const targetContainer = document.getElementById("targetButtons");
      targetButtonsValues.forEach(sec => {
        const btn = document.createElement("button");
        btn.textContent = sec + 'ì´ˆ';
        btn.onclick = () => {
          targetTime = sec;
          updateUI(); // ê°’ ë³€ê²½ í›„ UI ì—…ë°ì´íŠ¸ í˜¸ì¶œ
        };
        targetContainer.appendChild(btn);
      });

      const tolContainer = document.getElementById("toleranceButtons");
      toleranceButtonsValues.forEach(tol => {
        const btn = document.createElement("button");
        btn.textContent = tol.toFixed(1); // ì†Œìˆ˜ì  í•œ ìë¦¬ë¡œ í†µì¼
        btn.onclick = () => {
          tolerance = tol;
          updateUI(); // ê°’ ë³€ê²½ í›„ UI ì—…ë°ì´íŠ¸ í˜¸ì¶œ
        };
        tolContainer.appendChild(btn);
      });
      updateUI(); // ì´ˆê¸° UI ì—…ë°ì´íŠ¸
    }

    // ì§ì ‘ ì…ë ¥ ëª©í‘œ ì‹œê°„ ì„¤ì •
    function setCustomTarget() {
      const val = parseFloat(document.getElementById("customTarget").value);
      if (!isNaN(val) && val > 0) { // 0ë³´ë‹¤ í° ê°’ë§Œ í—ˆìš©
        targetTime = val;
        updateUI();
      } else {
        alert("ìœ íš¨í•œ ëª©í‘œ ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (0ë³´ë‹¤ í° ìˆ«ì).");
      }
    }

    // ì§ì ‘ ì…ë ¥ í—ˆìš© ì˜¤ì°¨ ì„¤ì •
    function setCustomTolerance() {
      const val = parseFloat(document.getElementById("customTolerance").value);
      if (!isNaN(val) && val >= 0) { // 0 ë˜ëŠ” ì–‘ìˆ˜ í—ˆìš©
        tolerance = val;
        updateUI();
      } else {
        alert("ìœ íš¨í•œ í—ˆìš© ì˜¤ì°¨ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (0 ë˜ëŠ” ì–‘ìˆ˜).");
      }
    }

    // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ (ì• ë‹ˆë©”ì´ì…˜ í”„ë ˆì„ ê¸°ë°˜)
    function updateTimer() {
      if (timerRunning) {
        const now = performance.now();
        const elapsed = (now - startTime) / 1000;
        timerEl.textContent = elapsed.toFixed(2);
        animationFrameId = requestAnimationFrame(updateTimer);
      }
    }

    // íƒ€ì´ë¨¸ ì‹œì‘
    function startTimer() {
      if (!timerRunning) {
        resultEl.textContent = "...ì¸¡ì • ì¤‘...";
        resultEl.className = "";
        timerEl.style.backgroundColor = 'white'; // ì‹œì‘ ì‹œ í°ìƒ‰
        startTime = performance.now();
        timerRunning = true;
        updateTimer();
        updateUI(); // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      }
    }

    // íƒ€ì´ë¨¸ ì •ì§€ ë° ê²°ê³¼ ê³„ì‚°
    function stopTimer() {
      if (timerRunning) {
        cancelAnimationFrame(animationFrameId); // ì• ë‹ˆë©”ì´ì…˜ í”„ë ˆì„ ì¤‘ë‹¨
        timerRunning = false;
        const endTime = performance.now();
        const elapsed = (endTime - startTime) / 1000;
        timerEl.textContent = elapsed.toFixed(2); // ìµœì¢… ì‹œê°„ í‘œì‹œ

        // ì˜¤ì°¨ ê³„ì‚°: ì ˆëŒ€ ì˜¤ì°¨
        const diff = Math.abs(elapsed - targetTime);

        // í—ˆìš© ì˜¤ì°¨ ë²”ìœ„ ë‚´ì— ìˆëŠ”ì§€ ë‚´ë¦¼/ì˜¬ë¦¼ìœ¼ë¡œ í™•ì¸
        // ê²½ê³¼ ì‹œê°„ì„ ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€ ì •í™•í•˜ê²Œ ë¹„êµí•˜ê¸° ìœ„í•´ Math.round ì‚¬ìš©
        const roundedElapsed = Math.round(elapsed * 100) / 100;

        // ëª©í‘œ ì‹œê°„ - í—ˆìš© ì˜¤ì°¨ (ë‚´ë¦¼)
        const lowerBound = Math.floor((targetTime - tolerance) * 100) / 100;
        // ëª©í‘œ ì‹œê°„ + í—ˆìš© ì˜¤ì°¨ (ì˜¬ë¦¼)
        const upperBound = Math.ceil((targetTime + tolerance) * 100) / 100;
        
        // ê²½ê³¼ ì‹œê°„ì´ í•˜í•œì„  <= ê²½ê³¼ ì‹œê°„ <= ìƒí•œì„  ì¸ì§€ í™•ì¸
        if (roundedElapsed >= lowerBound && roundedElapsed <= upperBound) {
          resultEl.textContent = `ğŸ‰ ì„±ê³µ! ${elapsed.toFixed(2)}ì´ˆ (ì˜¤ì°¨: Â±${diff.toFixed(2)}ì´ˆ)`;
          resultEl.className = "success";
          timerEl.style.backgroundColor = '#d4edda'; /* ì„±ê³µ ì‹œ ì—°í•œ ì´ˆë¡ìƒ‰ */
        } else {
          resultEl.textContent = `ğŸ˜¢ ì‹¤íŒ¨! ${elapsed.toFixed(2)}ì´ˆ (ì˜¤ì°¨: Â±${diff.toFixed(2)}ì´ˆ)`;
          resultEl.className = "fail";
          timerEl.style.backgroundColor = '#f8d7da'; /* ì‹¤íŒ¨ ì‹œ ì—°í•œ ë¹¨ê°„ìƒ‰ */
        }
        updateUI(); // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      }
    }

    // íƒ€ì´ë¨¸ ì´ˆê¸°í™”
    function resetTimer() {
      cancelAnimationFrame(animationFrameId); // í˜¹ì‹œ ëª¨ë¥¼ ì‹¤í–‰ ì¤‘ì¸ ì• ë‹ˆë©”ì´ì…˜ ì¤‘ë‹¨
      timerRunning = false;
      startTime = null;
      timerEl.textContent = "0.00";
      resultEl.textContent = "ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‹œì‘";
      resultEl.className = "";
      timerEl.style.backgroundColor = 'white'; // ì´ˆê¸°í™” ì‹œ í°ìƒ‰
      updateUI(); // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
    }

    // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ìŠ¤í˜ì´ìŠ¤ë°”ë¡œ ì‹œì‘/ì •ì§€, Rí‚¤ë¡œ ì´ˆê¸°í™” ìœ ì§€)
    document.addEventListener("keydown", (e) => {
      if (e.code === "Space") {
        e.preventDefault(); // ìŠ¤í˜ì´ìŠ¤ë°” ìŠ¤í¬ë¡¤ ë°©ì§€
        if (!timerRunning) {
          startTimer();
        } else {
          stopTimer();
        }
      } else if (e.key === "r" || e.key === "R") {
        resetTimer();
      }
    });

    // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼: ë²„íŠ¼ ì™¸ ì˜ì—­ í„°ì¹˜ ì‹œ ì‹œì‘/ì •ì§€)
    document.addEventListener("touchstart", (e) => {
      // í„°ì¹˜ ì´ë²¤íŠ¸ê°€ ë²„íŠ¼ì´ë‚˜ ì…ë ¥ì°½ì—ì„œ ë°œìƒí•œ ê²ƒì´ ì•„ë‹ˆë¼ë©´ (ì˜¤ì‘ë™ ë°©ì§€)
      if (e.target.tagName !== 'BUTTON' && e.target.tagName !== 'INPUT') {
        if (!timerRunning) {
          startTimer();
        } else {
          stopTimer();
        }
      }
    });

    // ì´ˆê¸° ì„¤ì •
    createButtons();
  </script>
</body>
</html>
